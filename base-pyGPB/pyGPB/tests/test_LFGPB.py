import pytest
import numpy as np
from pyGPB import LFGPB, GPB

simple_test_cases = [{'probs': [0.636117344134],
                      'weights': [1],
                      'rho': 0.28072848163164166,
                      'expected_pmf': [0.363882655866, 0.636117344134]},
                     {'probs': [0.479187631308],
                      'weights': [2],
                      'rho': 0.9675369901106516,
                      'expected_pmf': [0.520812368692, 0., 0.479187631308]},
                     {'probs': [0.078860284938],
                      'weights': [1],
                      'rho': 0.5897512517832665,
                      'expected_pmf': [0.921139715062, 0.078860284938]},
                     {'probs': [0.796903447472, 0.41850572803],
                      'weights': [9, 8],
                      'rho': 0.5057827877082934,
                      'expected_pmf': [0.171712181256, 0., 0., 0.,
                                       0., 0., 0., 0.,
                                       0.031384371272, 0.409782090714, 0., 0.,
                                       0., 0., 0., 0.,
                                       0., 0.387121356758]},
                     {'probs': [0.879596362569, 0.657742025708],
                      'weights': [6, 7],
                      'rho': 0.57651614576934,
                      'expected_pmf': [0.089247843742, 0., 0., 0.,
                                       0., 0., 0.25301013055, 0.031155793688,
                                       0., 0., 0., 0.,
                                       0., 0.62658623202]},
                     {'probs': [0.221484567908, 0.471336913079],
                      'weights': [7, 10],
                      'rho': 0.5025155093859732,
                      'expected_pmf': [0.472962198309, 0., 0., 0.,
                                       0., 0., 0., 0.055700888612,
                                       0., 0., 0.305553233783, 0.,
                                       0., 0., 0., 0.,
                                       0., 0.165783679296]},
                     {'probs': [0.832492680473, 0.216477094802, 0.16810026987],
                      'weights': [10, 1, 2],
                      'rho': 0.8257027349251572,
                      'expected_pmf': [1.673665983557e-01, 1.046594808857e-04, 3.381415124519e-05,
                                       2.247538928341e-06, 0.000000000000e+00, 0.000000000000e+00,
                                       0.000000000000e+00, 0.000000000000e+00, 0.000000000000e+00,
                                       0.000000000000e+00, 5.730879858442e-01, 9.134048644915e-02,
                                       4.303450684657e-02, 1.250297013334e-01]},
                     {'probs': [0.671523028906, 0.288877589811, 0.812261809149],
                      'weights': [2, 8, 10],
                      'rho': 0.8947572287226545,
                      'expected_pmf': [1.745160509686e-01, 0.000000000000e+00, 1.318024287153e-02,
                                       0.000000000000e+00, 0.000000000000e+00, 0.000000000000e+00,
                                       0.000000000000e+00, 0.000000000000e+00, 9.848260498480e-06,
                                       0.000000000000e+00, 1.530309303563e-01, 0.000000000000e+00,
                                       3.704272347437e-01, 0.000000000000e+00, 0.000000000000e+00,
                                       0.000000000000e+00, 0.000000000000e+00, 0.000000000000e+00,
                                       9.521902597363e-04, 0.000000000000e+00, 2.878835025397e-01]},
                     {'probs': [0.017853978128, 0.988347042511, 0.038757820473],
                      'weights': [9, 6, 10],
                      'rho': 0.33496552656762335,
                      'expected_pmf': [1.161240711909e-02, 0.000000000000e+00, 0.000000000000e+00,
                                       0.000000000000e+00, 0.000000000000e+00, 0.000000000000e+00,
                                       9.346455238890e-01, 0.000000000000e+00, 0.000000000000e+00,
                                       9.569537878851e-06, 3.074177982252e-05, 0.000000000000e+00,
                                       0.000000000000e+00, 0.000000000000e+00, 0.000000000000e+00,
                                       1.497467898114e-02, 3.585734908446e-02, 0.000000000000e+00,
                                       0.000000000000e+00, 2.390523059424e-07, 0.000000000000e+00,
                                       0.000000000000e+00, 0.000000000000e+00, 0.000000000000e+00,
                                       0.000000000000e+00, 2.869490556291e-03]},
                     {'probs': [0.096942331206, 0.604236807864, 0.832173784564, 0.590286810516],
                      'weights': [8, 1, 4, 7],
                      'rho': 0.6371726920403405,
                      'expected_pmf': [1.152843366440e-01, 2.064953220045e-02, 0.000000000000e+00,
                                       0.000000000000e+00, 1.509494938004e-01, 1.183261664098e-01,
                                       0.000000000000e+00, 1.859435826973e-02, 1.291069349056e-02,
                                       8.064342376096e-05, 0.000000000000e+00, 1.068419325581e-01,
                                       3.603185581206e-01, 3.605614305616e-03, 0.000000000000e+00,
                                       7.287741021070e-05, 2.337739976447e-04, 0.000000000000e+00,
                                       0.000000000000e+00, 3.202790753530e-03, 8.892922861552e-02]},
                     {'probs': [0.016634950227, 0.184886818254, 0.206956451228, 0.563046275061],
                      'weights': [6, 7, 2, 2],
                      'rho': 0.22248230898816201,
                      'expected_pmf': [0.324868548629, 0., 0.384572873076, 0.,
                                       0.095069637168, 0., 0.002046432016, 0.043681587771,
                                       0.005609523129, 0.094359614378, 0.002946167728, 0.040812788752,
                                       0., 0.000664378039, 0., 0.002933370219,
                                       0., 0.002435079096]},
                     {'probs': [0.260672738361, 0.007532498515, 0.203553257433, 0.844861036554],
                      'weights': [9, 4, 10, 10],
                      'rho': 0.4495577452067334,
                      'expected_pmf': [1.380072338115e-01, 0.000000000000e+00, 0.000000000000e+00,
                                       0.000000000000e+00, 2.084886330731e-05, 0.000000000000e+00,
                                       0.000000000000e+00, 0.000000000000e+00, 0.000000000000e+00,
                                       9.653805522940e-03, 5.028394615521e-01, 0.000000000000e+00,
                                       0.000000000000e+00, 1.108799078865e-05, 9.045475121479e-04,
                                       0.000000000000e+00, 0.000000000000e+00, 0.000000000000e+00,
                                       0.000000000000e+00, 1.509326936262e-01, 9.656978770725e-02,
                                       0.000000000000e+00, 0.000000000000e+00, 1.523050945166e-03,
                                       9.853821925724e-04, 0.000000000000e+00, 0.000000000000e+00,
                                       0.000000000000e+00, 0.000000000000e+00, 9.446451926525e-02,
                                       0.000000000000e+00, 0.000000000000e+00, 0.000000000000e+00,
                                       4.087581010714e-03]},
                     {'probs': [0.806683380398, 0.847095097089, 0.480203653449, 0.06979657325,
                                0.881028251886],
                      'weights': [10, 2, 9, 1, 1],
                      'rho': 0.04428879544365305,
                      'expected_pmf': [0.002693569692, 0.015008758013, 0.011964028412, 0.071116948042,
                                       0.004537537464, 0., 0., 0.,
                                       0., 0.001816867181, 0.019829966268, 0.062504723873,
                                       0.103897456699, 0.292944840275, 0.021477428611, 0.,
                                       0., 0., 0., 0.006341951427,
                                       0.045632009304, 0.036870299019, 0.279472643065, 0.023890972655]},
                     {'probs': [0.081656565474, 0.412936920049, 0.640420774481, 0.88972893819,
                                0.135296960259],
                      'weights': [1, 3, 7, 10, 6],
                      'rho': 0.9990888858539929,
                      'expected_pmf': [1.102710618098e-001, 0.000000000000e+000, 0.000000000000e+000,
                                       0.000000000000e+000, 0.000000000000e+000, 0.000000000000e+000,
                                       0.000000000000e+000, 8.983725986283e-113, 0.000000000000e+000,
                                       0.000000000000e+000, 2.493081637087e-001, 0.000000000000e+000,
                                       0.000000000000e+000, 1.169947881133e-046, 0.000000000000e+000,
                                       0.000000000000e+000, 0.000000000000e+000, 2.274838544329e-001,
                                       6.751437107422e-225, 0.000000000000e+000, 2.776399597894e-001,
                                       4.112570645811e-015, 0.000000000000e+000, 3.035099223659e-116,
                                       6.225227137600e-322, 0.000000000000e+000, 5.364039478542e-002,
                                       8.165656547379e-002]},
                     {'probs': [0.017975797133, 0.569936676499, 0.8635203983, 0.953271555034,
                                0.856069196383],
                      'weights': [10, 1, 5, 10, 4],
                      'rho': 0.37464908594027013,
                      'expected_pmf': [7.582072206247e-03, 1.007611349636e-03, 0.000000000000e+00,
                                       0.000000000000e+00, 6.794625853691e-03, 9.139893196805e-03,
                                       1.992103693043e-03, 0.000000000000e+00, 0.000000000000e+00,
                                       1.295686941359e-02, 3.321724514941e-02, 7.868100412441e-03,
                                       0.000000000000e+00, 0.000000000000e+00, 5.146187236903e-02,
                                       8.904161021381e-02, 3.647267837520e-02, 0.000000000000e+00,
                                       0.000000000000e+00, 2.604153643271e-01, 4.641316231503e-01,
                                       9.958737474763e-06, 0.000000000000e+00, 0.000000000000e+00,
                                       7.597372352023e-05, 2.608268815131e-04, 1.964501174520e-04,
                                       0.000000000000e+00, 0.000000000000e+00, 1.974716882137e-03,
                                       1.540040394755e-02]},
                     {'probs': [0.271431774542, 0.429760698368, 0.118905019601, 0.714857424545,
                                0.584184860682, 0.912215734233],
                      'weights': [9, 2, 3, 2, 2, 1],
                      'rho': 0.9159835582830245,
                      'expected_pmf': [8.663294480010e-02, 1.810719834819e-01, 1.119800768408e-03,
                                       1.473411960329e-01, 3.114615777632e-05, 1.579738413422e-01,
                                       2.728112083533e-06, 1.503250364006e-01, 1.460204157355e-04,
                                       5.478995156625e-09, 3.944892997900e-03, 1.179686941628e-08,
                                       6.987778985582e-04, 7.580375568196e-09, 1.137203971141e-02,
                                       5.011683465344e-07, 1.445064747257e-01, 1.697315529301e-04,
                                       9.757772438349e-14, 1.146628595770e-01]},
                     {'probs': [0.066580668353, 0.417971911, 0.339107303554, 0.204525886659,
                                0.650162035551, 0.725157427612],
                      'weights': [6, 4, 8, 2, 4, 8],
                      'rho': 0.16731532105712088,
                      'expected_pmf': [0.058935087944, 0., 0.00613975898, 0.,
                                       0.08041118781, 0., 0.013765859064, 0.,
                                       0.131518936847, 0., 0.025411256962, 0.,
                                       0.198748198798, 0., 0.050479966631, 0.,
                                       0.136087375995, 0., 0.052218552974, 0.,
                                       0.087498422035, 0., 0.038051447735, 0.,
                                       0.067430851158, 0., 0.036281995765, 0.,
                                       0.003516313067, 0., 0.008003277423, 0.,
                                       0.005501510813]},
                     {'probs': [0.929337487515, 0.909481809067, 0.773079077043, 0.286364066674,
                                0.028434748312, 0.634268276952],
                      'weights': [2, 8, 3, 2, 2, 9],
                      'rho': 0.03783853048754271,
                      'expected_pmf': [6.549702180603e-04, 0.000000000000e+00, 6.410874336510e-03,
                                       1.635680278973e-03, 2.079785877336e-03, 1.798309548039e-02,
                                       4.476137066210e-05, 6.476699370516e-03, 4.769633681333e-03,
                                       9.907206188537e-04, 5.333434298183e-02, 2.240711436285e-02,
                                       2.179159937607e-02, 1.715758850853e-01, 2.855935445212e-02,
                                       6.860676955148e-02, 1.116883952451e-02, 8.728900205092e-03,
                                       3.154198784497e-04, 8.447501031512e-02, 2.071521574528e-02,
                                       3.418021261875e-02, 2.948159029907e-01, 9.877262222355e-04,
                                       1.328669902176e-01, 0.000000000000e+00, 4.424495240032e-03]},
                     {'probs': [0.356365726212, 0.118292368444, 0.622504051786, 0.555313921102,
                                0.707119894003, 0.323694270432, 0.839054912804],
                      'weights': [2, 6, 10, 6, 4, 9, 10],
                      'rho': 0.4480781444233375,
                      'expected_pmf': [0.051809822595, 0., 0.002329054449, 0.,
                                       0.021902952725, 0., 0.011073587298, 0.,
                                       0.000972990349, 0.001812520746, 0.080122733813, 0.000228542938,
                                       0.009607366085, 0.00184881641, 0.064420578396, 0.001196192127,
                                       0.041251269604, 0.000177252304, 0.006053012848, 0.007600231907,
                                       0.078096202197, 0.002045943448, 0.027237624653, 0.011544278261,
                                       0.055061990101, 0.009866355831, 0.048947377245, 0.002074036199,
                                       0.011710478814, 0.02166772978, 0.075988789013, 0.015021086244,
                                       0.063967455925, 0.019439331194, 0.00103510872, 0.025058856825,
                                       0.00915619245, 0.008527653922, 0.015561142289, 0.051458359093,
                                       0., 0.084364678376, 0., 0.001211819547,
                                       0., 0.012694701255, 0., 0.045855884025]},
                     {'probs': [0.568966870367, 0.293030798683, 0.661618478417, 0.300090705089,
                                0.542070256857, 0.731641345905, 0.677046083175],
                      'weights': [6, 3, 7, 8, 5, 2, 5],
                      'rho': 0.3094705084154177,
                      'expected_pmf': [0.036021442629, 0., 0.025614213661, 0.002135207568,
                                       0., 0.030657890587, 0.010544939175, 0.050126574192,
                                       0.01778292262, 0.021367025757, 0.0187052236, 0.016252730353,
                                       0.040752615157, 0.039177948837, 0.044986422027, 0.032203970292,
                                       0.018100899449, 0.026137984392, 0.04353495504, 0.03458797442,
                                       0.063127530152, 0.023006996054, 0.027243610972, 0.043568972075,
                                       0.00585770498, 0.066675707654, 0.021365850338, 0.015264210436,
                                       0.070593487239, 0.008626630462, 0.010835383658, 0.023868698873,
                                       0., 0.046550976499, 0.003954463502, 0.,
                                       0.060768837351]},
                     {'probs': [0.165993438002, 0.587984813418, 0.741186220316, 0.23612417581,
                                0.177395021826, 0.601503409293, 0.199455273554],
                      'weights': [4, 5, 6, 4, 9, 4, 10],
                      'rho': 0.2750567587538948,
                      'expected_pmf': [6.878943352530e-02, 0.000000000000e+00, 0.000000000000e+00,
                                       0.000000000000e+00, 4.540830564101e-02, 3.532356839753e-02,
                                       8.006651299497e-02, 0.000000000000e+00, 8.041771436192e-03,
                                       4.225420961889e-02, 9.341489729854e-02, 6.862456131907e-02,
                                       6.466683108630e-04, 1.529932274509e-02, 3.452538716807e-02,
                                       1.357740825343e-01, 7.920779205364e-03, 2.648978263308e-03,
                                       1.049985216383e-02, 8.218414569459e-02, 2.523410724188e-02,
                                       1.181218780464e-02, 2.882538400702e-03, 2.362580785974e-02,
                                       3.848953922041e-02, 3.680511861491e-02, 5.317777308498e-04,
                                       2.339387254550e-03, 2.757876100436e-02, 3.243613942743e-02,
                                       2.842275352107e-03, 6.610166490549e-05, 9.297618775917e-03,
                                       1.252037229574e-02, 1.391170241134e-02, 0.000000000000e+00,
                                       3.423549019551e-04, 9.428929199194e-04, 1.765474292406e-02,
                                       0.000000000000e+00, 0.000000000000e+00, 0.000000000000e+00,
                                       9.264097877695e-03]},
                     {'probs': [0.864927189329, 0.269459620425, 0.245015592676, 0.008968486964,
                                0.493756529734, 0.278881297615, 0.780865592355, 0.825715875004],
                      'weights': [4, 4, 5, 3, 4, 9, 3, 6],
                      'rho': 0.6303232470922058,
                      'expected_pmf': [5.176567898427e-02, 0.000000000000e+00, 0.000000000000e+00,
                                       1.610452065708e-02, 4.138629402466e-02, 9.796424383785e-05,
                                       2.523116545172e-02, 3.877772621286e-02, 4.623652016617e-03,
                                       2.353466780988e-02, 6.105412692680e-02, 1.172134602406e-02,
                                       1.663137288193e-03, 1.549444785991e-01, 1.953462186216e-02,
                                       3.578686177853e-03, 2.892441522415e-03, 1.328209468479e-01,
                                       2.006963962625e-02, 4.863513915529e-03, 1.811202589131e-03,
                                       4.140539369963e-02, 6.313255363597e-02, 3.145932193613e-03,
                                       7.873800576500e-04, 4.495460148803e-04, 8.459209598136e-02,
                                       7.667478702562e-03, 6.179554097022e-04, 6.932022887663e-04,
                                       4.188929094143e-02, 3.990782150915e-02, 3.172578708960e-04,
                                       5.434406058080e-04, 4.805600017026e-04, 9.085639486946e-02,
                                       0.000000000000e+00, 0.000000000000e+00, 7.037885437059e-03]},
                     {'probs': [0.42101840807, 0.608080522007, 0.514384743656, 0.236961795663,
                                0.946521899319, 0.398856819076, 0.189203367067, 0.948638211327],
                      'weights': [9, 8, 6, 8, 3, 2, 9, 2],
                      'rho': 0.30385153030391787,
                      'expected_pmf': [4.349710448831e-03, 0.000000000000e+00, 1.513288782898e-02,
                                       1.421759295351e-02, 1.933527290555e-03, 9.452055976422e-02,
                                       5.730277522272e-04, 2.333709841863e-02, 4.736003185436e-03,
                                       3.844403809141e-03, 7.479962373067e-03, 5.185079134853e-02,
                                       3.977614692247e-03, 9.584929693893e-02, 3.289064864913e-02,
                                       3.242190162416e-02, 1.669507063141e-02, 3.880731818192e-03,
                                       2.539410723966e-03, 6.136791995778e-02, 2.737924853047e-02,
                                       5.146147770021e-02, 6.262813465336e-02, 1.091825352569e-02,
                                       3.146196253245e-02, 3.852105358414e-03, 1.565323100922e-03,
                                       1.509342600196e-02, 5.641053513477e-02, 1.952404363201e-02,
                                       7.195133288325e-02, 1.131936670911e-02, 1.207692622369e-02,
                                       8.097080507201e-03, 4.221540908670e-04, 3.884273751186e-04,
                                       2.203741200010e-02, 1.420453839581e-02, 3.873385160437e-02,
                                       2.793477070072e-02, 8.363915146248e-07, 4.875830685981e-03,
                                       5.296266297315e-05, 4.913671718408e-05, 6.817107918217e-05,
                                       9.007445441281e-03, 0.000000000000e+00, 2.688708615245e-02]},
                     {'probs': [0.244823869991, 0.298226514843, 0.748991041824, 0.459866511826,
                                0.50804382312, 0.769474827704, 0.567054383629, 0.0727309727],
                      'weights': [4, 2, 4, 3, 4, 6, 5, 4],
                      'rho': 0.08281825385847774,
                      'expected_pmf': [0.008925991745, 0., 0.002001303594, 0.004277139339,
                                       0.022843217584, 0.00791844512, 0.023919305796, 0.014927213915,
                                       0.02498132025, 0.035089365756, 0.061079412429, 0.037258259419,
                                       0.035483494179, 0.064661846583, 0.064728560127, 0.083464198507,
                                       0.037341671608, 0.067718571163, 0.067239741024, 0.081327678406,
                                       0.032966222997, 0.04134425464, 0.062643134714, 0.026386680647,
                                       0.034227439211, 0.011936064197, 0.022864253801, 0.002161276601,
                                       0.015322514393, 0.001044070528, 0.002150393153, 0.,
                                       0.001766958574]},
                     {'probs': [0.677849001924, 0.502809874714, 0.815346449838, 0.775451022823,
                                0.548310088727, 0.062408284964, 0.827201100448, 0.837359823911,
                                0.658080443201],
                      'weights': [3, 7, 7, 1, 3, 3, 4, 7, 10],
                      'rho': 0.21487001209205459,
                      'expected_pmf': [2.370413101121e-03, 1.674438098833e-03, 0.000000000000e+00,
                                       1.479532222636e-03, 3.824063757504e-03, 2.312719554366e-03,
                                       3.016903895405e-04, 7.584677922192e-03, 7.831461016632e-03,
                                       2.724474854973e-06, 5.957942711515e-03, 1.513293816927e-02,
                                       9.621341908209e-03, 2.049359118051e-03, 1.765807712626e-02,
                                       2.379813738513e-02, 2.352075564824e-04, 1.328781603150e-02,
                                       3.348424696673e-02, 1.596760873837e-02, 5.950103477581e-03,
                                       3.352820228758e-02, 4.929397848804e-02, 1.295515165305e-03,
                                       2.460881856699e-02, 6.466669169760e-02, 7.873102160326e-03,
                                       1.113616068173e-02, 5.047066819608e-02, 4.811889431603e-02,
                                       2.972243905631e-03, 3.695888425165e-02, 1.047950700770e-01,
                                       9.685221218797e-05, 1.805437300204e-02, 9.689988147818e-02,
                                       1.520985781481e-02, 2.647804489753e-03, 3.022672531218e-02,
                                       7.293664362286e-02, 9.666407716654e-05, 1.501022690962e-02,
                                       1.224984279977e-01, 0.000000000000e+00, 1.255486752309e-03,
                                       1.882432681038e-02]},
                     {'probs': [0.929692666052, 0.812915753759, 0.184048207158, 0.929047896074,
                                0.983611714341, 0.80489203858, 0.459558859448, 0.314355319031,
                                0.032527676446],
                      'weights': [5, 7, 2, 1, 6, 4, 9, 7, 9],
                      'rho': 0.7177182893959696,
                      'expected_pmf': [7.813168283935e-03, 1.997557741739e-03, 8.085565793289e-09,
                                       2.188887290237e-08, 2.349285733218e-04, 2.247870277457e-03,
                                       1.881738994114e-02, 1.606666896751e-02, 2.438298600031e-04,
                                       2.273288381617e-04, 2.676428754680e-03, 2.204318483986e-02,
                                       4.370256824446e-02, 2.965683745824e-03, 6.634062606542e-03,
                                       6.115133637984e-03, 5.021163495986e-02, 1.262586371141e-03,
                                       1.341992907791e-02, 5.542350462491e-02, 4.424735202493e-04,
                                       2.502362868951e-03, 6.533189489864e-03, 2.161012400669e-01,
                                       2.681632286358e-04, 1.856995140806e-02, 2.355997304313e-03,
                                       1.234731918314e-03, 9.149693690096e-03, 1.887151276815e-04,
                                       4.367147550329e-02, 7.380419108099e-04, 1.578797629969e-01,
                                       1.493144448648e-05, 3.114376607921e-02, 1.337235545010e-03,
                                       4.793113611438e-06, 1.489474813097e-04, 6.640852847257e-05,
                                       1.181046440336e-01, 4.194006629416e-06, 1.063910542834e-01,
                                       1.374374275705e-08, 1.016384085288e-03, 2.542745232343e-06,
                                       1.567954673413e-08, 1.291982042743e-06, 5.124794900680e-08,
                                       4.328114169322e-03, 1.619322604046e-08, 2.569630728294e-02]},
                     {'probs': [0.909699084556, 0.40683060732, 0.100832101043, 0.159358017405,
                                0.670373578362, 0.414965988484, 0.470184925958, 0.529224215347,
                                0.716062716536],
                      'weights': [2, 9, 2, 9, 3, 10, 5, 2, 4],
                      'rho': 0.23003990502833327,
                      'expected_pmf': [0.009731095995, 0., 0.030605130626, 0.005120568401,
                                       0.018322215172, 0.026207889827, 0.031340341213, 0.027978961441,
                                       0.019049831076, 0.045071109281, 0.01299895822, 0.051215365679,
                                       0.019126545267, 0.020969451247, 0.038689572745, 0.021799073065,
                                       0.050846587109, 0.022163784714, 0.037061199148, 0.028353067186,
                                       0.038795586413, 0.038669500661, 0.020078063178, 0.033374135717,
                                       0.023396117087, 0.040476911109, 0.036360727184, 0.016153984369,
                                       0.023054936649, 0.010561047751, 0.031926256485, 0.010181722228,
                                       0.01735612224, 0.020467783111, 0.010885677164, 0.047261976559,
                                       0.003571966887, 0.015300908984, 0.000957454204, 0.007593368055,
                                       0.001877770712, 0.004051937299, 0.005258347848, 0.000579834056,
                                       0.018016749243, 0., 0.007140367393]},
                     {'probs': [0.017505976739, 0.323252227497, 0.180698310896, 0.873296691855,
                                0.673043013899, 0.340084016103, 0.105588198078, 0.820952320913,
                                0.007742444303, 0.980998982843],
                      'weights': [5, 10, 9, 8, 5, 10, 1, 4, 4, 7],
                      'rho': 0.8179581926255695,
                      'expected_pmf': [1.681555433644e-02, 1.189238090178e-11, 0.000000000000e+00,
                                       0.000000000000e+00, 4.866445699771e-04, 4.128937442120e-05,
                                       3.207538938659e-12, 7.208206759821e-02, 1.317613801464e-03,
                                       1.350225193348e-05, 1.265990270087e-07, 2.603561703821e-02,
                                       3.903908437115e-03, 3.239727092733e-05, 9.772453918748e-08,
                                       6.408152717526e-02, 6.942535495357e-03, 7.777808765010e-05,
                                       2.376124792386e-07, 1.310594696365e-01, 1.905706469500e-02,
                                       2.075625383067e-04, 3.022588713737e-05, 6.983481555662e-08,
                                       2.269315257164e-01, 2.114844449563e-03, 3.203052414797e-04,
                                       1.013616166584e-06, 4.787782832367e-04, 1.142969478264e-02,
                                       1.215056592385e-03, 6.820164545946e-06, 4.786633422708e-07,
                                       8.333191154000e-03, 1.294317028580e-01, 5.575035484763e-03,
                                       1.932575949627e-05, 3.520062866713e-07, 3.470204770715e-04,
                                       1.465989044668e-03, 1.351800161095e-04, 9.773443262130e-07,
                                       3.816654549345e-09, 2.421988438986e-02, 8.617569320399e-02,
                                       1.638803997024e-02, 2.661079281087e-08, 6.453065936045e-06,
                                       2.423328795766e-04, 3.765269428826e-04, 3.399138104630e-04,
                                       2.114367852682e-11, 2.394020497950e-07, 6.357694182939e-02,
                                       5.883722599224e-02, 2.752817287940e-10, 9.682330419655e-21,
                                       2.919483593278e-04, 4.323093264845e-03, 1.071786460508e-02,
                                       0.000000000000e+00, 0.000000000000e+00, 6.942039440840e-05,
                                       4.441809531523e-03]},
                     {'probs': [0.343831263408, 0.680344173254, 0.436584847155, 0.182429346306,
                                0.260590953725, 0.744083182057, 0.215381451775, 0.640221472313,
                                0.548181887248, 0.746276079134],
                      'weights': [6, 8, 1, 8, 2, 6, 9, 5, 10, 1],
                      'rho': 0.3154923745108045,
                      'expected_pmf': [0.02386406955, 0.017521413885, 0.003599722167, 0.001096344222,
                                       0.000294103678, 0.008088382609, 0.025762460907, 0.022042094961,
                                       0.017234319878, 0.015397131341, 0.01020532727, 0.016348507693,
                                       0.019964302553, 0.016256765719, 0.026381287347, 0.031368857898,
                                       0.023391849005, 0.019654590218, 0.015884992903, 0.021329669526,
                                       0.033523522189, 0.029621377988, 0.02661077695, 0.024190980896,
                                       0.024544369849, 0.029629048577, 0.024533912424, 0.01823802034,
                                       0.017622291657, 0.02462667357, 0.040154626884, 0.03986937269,
                                       0.022851892145, 0.021982181214, 0.012202155808, 0.011961744209,
                                       0.022497585249, 0.026728193624, 0.020686376097, 0.032838250457,
                                       0.018063674674, 0.01298264096, 0.010446422919, 0.003485533608,
                                       0.007161627768, 0.015884181426, 0.016951413254, 0.017651480119,
                                       0.018548689422, 0.002684582159, 0.005514443783, 0.000872199344,
                                       0.000191828681, 0.002755328826, 0.007866973733, 0.003266263052,
                                       0.015073170121]},
                     {'probs': [0.5070619853, 0.67949354546, 0.011443144978, 0.538758447611,
                                0.982644573531, 0.339925858541, 0.942019270521, 0.608541695774,
                                0.745310044118, 0.022927152479],
                      'weights': [10, 5, 7, 7, 7, 9, 7, 6, 1, 2],
                      'rho': 0.4957033782770287,
                      'expected_pmf': [4.286243542730e-03, 5.379731648428e-04, 8.874200039271e-09,
                                       6.271864857773e-09, 0.000000000000e+00, 3.221079661611e-04,
                                       2.861693953578e-04, 2.341638731255e-02, 7.295667895454e-03,
                                       2.000670990491e-05, 9.437449302326e-05, 6.693731099334e-05,
                                       4.581508708116e-03, 5.731078541028e-03, 5.530691126092e-02,
                                       3.730520993237e-02, 4.095668645584e-04, 1.716430580468e-03,
                                       2.152805882232e-03, 2.512186996661e-02, 4.712336431603e-02,
                                       3.023496796595e-02, 1.420737821329e-02, 3.802473299828e-03,
                                       1.228766596563e-02, 2.430849670308e-02, 4.123803709319e-02,
                                       2.682100449249e-02, 1.660435330555e-02, 1.583985668076e-02,
                                       2.779237243401e-02, 1.722404827578e-02, 1.617039311206e-02,
                                       4.171888568177e-02, 4.928974749518e-03, 2.190231922167e-02,
                                       4.818744705956e-02, 3.035890840299e-02, 1.582585524868e-02,
                                       8.029638710206e-03, 5.144520688097e-03, 5.900018171422e-03,
                                       3.894415348560e-02, 8.491090844527e-02, 3.590814300848e-03,
                                       2.959365624343e-02, 1.701437936833e-02, 1.024813875585e-02,
                                       4.197723044757e-04, 5.808174877613e-04, 1.059765561523e-03,
                                       5.553592522199e-03, 1.414354537258e-01, 2.752584558242e-04,
                                       1.353290887739e-02, 1.441896897392e-05, 7.134544959407e-06,
                                       0.000000000000e+00, 4.466470632009e-05, 6.255217108663e-03,
                                       3.345244800641e-06, 2.213355426986e-03]}]

four_param_test_cases = [{'probs': [0.431072606587],
                          'weights': [-2],
                          'rho': 0.902567503744367,
                          'weights_failure': [-1],
                          'expected_pmf': [0.431072606587, 0.568927393413],
                          'support_min': -2,
                          'support_max': -1},
                         {'probs': [0.840130973992],
                          'weights': [0],
                          'rho': 0.14817185725828996,
                          'weights_failure': [1],
                          'expected_pmf': [0.840130973992, 0.159869026008],
                          'support_min': 0,
                          'support_max': 1},
                         {'probs': [0.97027287042],
                          'weights': [3],
                          'rho': 0.2700033825748721,
                          'weights_failure': [2],
                          'expected_pmf': [0.02972712958, 0.97027287042],
                          'support_min': 2,
                          'support_max': 3},
                         {'probs': [0.434552604691, 0.89127891354],
                          'weights': [0, 2],
                          'rho': 0.3391483062826709,
                          'weights_failure': [1, -5],
                          'expected_pmf': [0.023525704068, 0.085195382392, 0., 0.,
                                           0., 0., 0., 0.411026900622,
                                           0.480252012918],
                          'support_min': -5,
                          'support_max': 3},
                         {'probs': [0.60608478081, 0.22175965341],
                          'weights': [-2, 3],
                          'rho': 0.8927289168566723,
                          'weights_failure': [3, 4],
                          'expected_pmf': [0.220951659414, 0.385133121396, 0., 0.,
                                           0., 0.000807993996, 0.393107225194],
                          'support_min': 1,
                          'support_max': 7},
                         {'probs': [0.217347754474, 0.849207515985],
                          'weights': [2, 5],
                          'rho': 0.7082223920108781,
                          'weights_failure': [-2, 1],
                          'expected_pmf': [0.149848002447, 0., 0., 0.,
                                           0.633748724648, 0., 0., 0.,
                                           0.216403272905],
                          'support_min': -1,
                          'support_max': 7},
                         {'probs': [0.382266226334, 0.264624121537, 0.117578025499],
                          'weights': [-3, -5, 1],
                          'rho': 0.9548814807365079,
                          'weights_failure': [-1, -1, -2],
                          'expected_pmf': [1.405860820343e-01, 0.000000000000e+00, 7.439829516971e-03,
                                           1.165720528350e-01, 1.241429960149e-01, 2.615715036600e-05,
                                           6.102530669344e-01, 9.650954502022e-04, 0.000000000000e+00,
                                           1.472006386112e-05],
                          'support_min': -10,
                          'support_max': -1},
                         {'probs': [0.907874973813, 0.6928260056, 0.734617543636],
                          'weights': [2, 2, 3],
                          'rho': 0.6175779952672416,
                          'weights_failure': [-2, 1, -2],
                          'expected_pmf': [0.055300788286, 0.010920464463, 0., 0.,
                                           0.108548896849, 0.10599135433, 0.010524725881, 0.,
                                           0., 0.127945261703, 0.580768508489],
                          'support_min': -3,
                          'support_max': 7},
                         {'probs': [0.252760766249, 0.537151408556, 0.840458361361],
                          'weights': [0, 3, -4],
                          'rho': 0.5170656731438323,
                          'weights_failure': [3, -2, 1],
                          'expected_pmf': [0.046927826465, 0., 0., 0.291028066279,
                                           0., 0.201894434035, 0., 0.,
                                           0.425500733281, 0., 0.003938505748, 0.,
                                           0., 0.030710434192],
                          'support_min': -6,
                          'support_max': 7},
                         {'probs': [0.621737873744, 0.669650719707, 0.896132243284, 0.306238612357],
                          'weights': [-4, 4, 3, -4],
                          'rho': 0.4439426997251483,
                          'weights_failure': [4, -2, -3, -5],
                          'expected_pmf': [0.014262753644, 0.001481060854, 0., 0.,
                                           0., 0., 0.109129921944, 0.031857522937,
                                           0.049002209739, 0.001854638374, 0., 0.,
                                           0.249711253754, 0.215295360611, 0.143397003398, 0.016631263509,
                                           0., 0., 0., 0.,
                                           0.128258245164, 0.039118766072],
                          'support_min': -14,
                          'support_max': 7},
                         {'probs': [0.146448140259, 0.055580108446, 0.622096484723, 0.357640226338],
                          'weights': [-5, -1, -5, -5],
                          'rho': 0.07594412840706133,
                          'weights_failure': [-3, -3, -3, 1],
                          'expected_pmf': [0.037361247486, 0., 0.199983921329, 0.,
                                           0.114662955458, 0., 0.058603813283, 0.,
                                           0.347239416308, 0., 0.232856009691, 0.,
                                           0.009292636445],
                          'support_min': -18,
                          'support_max': -6},
                         {'probs': [0.535899073748, 0.329204716669, 0.2024722394, 0.37589322795],
                          'weights': [4, -2, -1, 2],
                          'rho': 0.4492389016626994,
                          'weights_failure': [-2, -1, -4, 3],
                          'expected_pmf': [0.025154661602, 0.104691157758, 0.290134037286, 0.009575972215,
                                           0.017872117011, 0.01667298038, 0.079637594148, 0.145909110739,
                                           0.152001199067, 0.074909820098, 0.058069462984, 0.025371886711],
                          'support_min': -6,
                          'support_max': 5},
                         {'probs': [0.817886916008, 0.208246219161, 0.636964334398, 0.275571536165,
                                    0.516446061275],
                          'weights': [5, -4, 2, 0, 5],
                          'rho': 0.7036803741688976,
                          'weights_failure': [-2, 2, -2, 2, -1],
                          'expected_pmf': [1.776604393916e-05, 0.000000000000e+00, 2.791920088816e-04,
                                           0.000000000000e+00, 5.721145301830e-05, 0.000000000000e+00,
                                           1.147500285725e-03, 5.095450609582e-04, 1.361451147735e-01,
                                           2.520631642592e-03, 1.019833315123e-03, 6.043491318584e-03,
                                           2.587330649512e-02, 1.795735815594e-02, 9.043576533581e-03,
                                           1.489918035554e-01, 8.881217125777e-04, 1.540523875328e-01,
                                           7.641461370882e-03, 1.850899928338e-01, 0.000000000000e+00,
                                           4.909036342410e-02, 0.000000000000e+00, 9.654550716896e-02,
                                           0.000000000000e+00, 1.570858353145e-01],
                          'support_min': -9,
                          'support_max': 16},
                         {'probs': [0.14407863942, 0.391564766898, 0.909304305329, 0.974861009767,
                                    0.009568581076],
                          'weights': [5, -3, 3, 4, -4],
                          'rho': 0.6740206832696847,
                          'weights_failure': [-3, 4, -1, 3, 2],
                          'expected_pmf': [6.961876956058e-12, 7.102392712344e-08, 0.000000000000e+00,
                                           0.000000000000e+00, 1.116757251532e-09, 1.476007712800e-03,
                                           3.183085429303e-05, 2.444937874277e-03, 6.086608798999e-08,
                                           1.946112391665e-08, 1.636416520434e-04, 2.665424091938e-01,
                                           1.113700178038e-04, 2.340239012953e-02, 7.255024487839e-02,
                                           4.195393149550e-05, 6.710474094270e-09, 9.413785045262e-03,
                                           4.876652898899e-01, 1.129832161205e-01, 1.015787089643e-04,
                                           4.813071039703e-07, 1.031613466568e-04, 0.000000000000e+00,
                                           0.000000000000e+00, 5.106146064517e-06, 2.296243600578e-02],
                          'support_min': -8,
                          'support_max': 18},
                         {'probs': [0.700549730234, 0.023675791574, 0.892580524064, 0.014635830003,
                                    0.732064268809],
                          'weights': [3, -5, 1, 1, -1],
                          'rho': 0.006558699977149085,
                          'weights_failure': [-1, 1, -3, 2, -3],
                          'expected_pmf': [2.822242529873e-06, 1.956953218302e-04, 7.881875051911e-06,
                                           5.314739592336e-04, 3.094103926315e-05, 2.079710128272e-03,
                                           2.075127366500e-04, 1.438108108351e-02, 3.836203741824e-04,
                                           2.664571996487e-02, 1.441865317869e-03, 9.980543749067e-02,
                                           3.527336960185e-03, 2.400143984047e-01, 2.359178404750e-03,
                                           1.604301709408e-01, 6.674671052861e-03, 4.412804827028e-01],
                          'support_min': -11,
                          'support_max': 6},
                         {'probs': [0.26316219312, 0.661432343451, 0.275062766205, 0.394977927928,
                                    0.620937923675, 0.092997518987],
                          'weights': [-3, 3, 4, -5, -1, 3],
                          'rho': 0.17240050917099037,
                          'weights_failure': [-5, -2, -1, -2, 5, -3],
                          'expected_pmf': [0.032619183621, 0., 0.010969543783, 0.070515466835,
                                           0., 0.101623334171, 0.027727110275, 0.041001423197,
                                           0.136123110149, 0.081445387567, 0.081514606157, 0.070703402559,
                                           0.027155076704, 0.063588105901, 0.110443013382, 0.022289930073,
                                           0.050429137817, 0.004659975127, 0.013910717295, 0.028707565483,
                                           0.005531402647, 0.011082488809, 0.003868127801, 0.,
                                           0.001267692115, 0.00187244668, 0., 0.000951751853],
                          'support_min': -17,
                          'support_max': 10},
                         {'probs': [0.706028038113, 0.655643497708, 0.362072204899, 0.197113084446,
                                    0.804400185686, 0.219988846823],
                          'weights': [2, -2, -3, -4, 1, -3],
                          'rho': 0.08176333746058895,
                          'weights_failure': [4, 4, 1, -2, 4, -4],
                          'expected_pmf': [0.027156590348, 0.011912750926, 0.094918118897, 0.038506867231,
                                           0.069118575148, 0.041564946095, 0.170952188827, 0.064549532586,
                                           0.109128209549, 0.068168078853, 0.043414965841, 0.038587028616,
                                           0.091948768759, 0.029930405562, 0.043343270479, 0.034077446018,
                                           0.005060764718, 0.015244660698, 0.002416830847],
                          'support_min': -10,
                          'support_max': 8},
                         {'probs': [0.421517611846, 0.531633934813, 0.302381958829, 0.972394659516,
                                    0.901835618599, 0.86391682217],
                          'weights': [2, -1, 4, 3, 0, 4],
                          'rho': 0.15377283639683015,
                          'weights_failure': [3, -3, 1, 0, -3, 3],
                          'expected_pmf': [1.465641185495e-04, 1.171429818394e-03, 1.591171659992e-03,
                                           3.381905421402e-03, 2.282032466383e-02, 3.170402450512e-02,
                                           3.058799425641e-02, 1.504185234159e-01, 1.716505276644e-01,
                                           1.593275730182e-01, 2.063976844923e-01, 5.727550521504e-02,
                                           9.226256277542e-02, 7.126420897505e-02],
                          'support_min': 0,
                          'support_max': 13},
                         {'probs': [0.533183619569, 0.258507653144, 0.332758259683, 0.542098351054,
                                    0.538827037349, 0.333022801826, 0.654587788161],
                          'weights': [5, 1, 1, -1, -5, 1, 1],
                          'rho': 0.9433119837702257,
                          'weights_failure': [-1, -2, 5, -4, 3, 0, -3],
                          'expected_pmf': [2.132852119457e-05, 5.432720454706e-07, 0.000000000000e+00,
                                           3.233654665399e-05, 7.226745238833e-03, 5.562052424690e-05,
                                           2.780013385586e-05, 4.088266143368e-03, 1.972942896151e-02,
                                           4.546709326866e-04, 3.557670745074e-03, 2.320886961131e-02,
                                           3.182776357466e-01, 3.330776922232e-02, 7.312089379607e-02,
                                           9.310102145611e-03, 7.597106436358e-02, 3.112508582512e-01,
                                           3.800060461173e-02, 2.036874829606e-02, 6.689913722470e-03,
                                           1.461568643804e-02, 1.781506481735e-02, 3.329328407849e-04,
                                           8.957764884460e-05, 2.051914110500e-02, 1.600302360869e-03,
                                           0.000000000000e+00, 2.392111339160e-04, 8.721286881145e-05],
                          'support_min': -14,
                          'support_max': 15},
                         {'probs': [0.705236612122, 0.036965179674, 0.058391812293, 0.621413131309,
                                    0.423609248892, 0.345238598467, 0.172109302168],
                          'weights': [4, -2, -3, -2, -4, -3, -4],
                          'rho': 0.3282727483011111,
                          'weights_failure': [-2, -1, 4, 0, -3, 4, -5],
                          'expected_pmf': [6.106163986885e-05, 8.608814996233e-04, 9.682292001202e-04,
                                           3.863483965852e-04, 2.951423054678e-04, 4.360223762660e-05,
                                           1.565828301163e-03, 1.304516830680e-02, 2.678853469277e-02,
                                           2.496033013405e-02, 1.100261716914e-02, 1.621067709447e-02,
                                           1.262326464111e-03, 6.333639043264e-03, 8.648594981829e-02,
                                           1.265144738181e-01, 1.059332893732e-01, 6.202062737456e-02,
                                           1.097569759805e-01, 3.832083067756e-03, 3.400212807104e-03,
                                           8.743136817251e-02, 1.375166410920e-01, 5.951902482123e-02,
                                           1.058604870935e-01, 7.944480096248e-03],
                          'support_min': -21,
                          'support_max': 4},
                         {'probs': [0.749535328792, 0.060408807182, 0.80991782689, 0.456027674329,
                                    0.808669255856, 0.074766792848, 0.261342273199],
                          'weights': [-1, -1, 2, 2, 1, -1, -3],
                          'rho': 0.8815498035994781,
                          'weights_failure': [3, -5, 3, 4, -2, 5, 4],
                          'expected_pmf': [5.601287468520e-09, 1.323529355534e-12, 1.297877818304e-09,
                                           3.060072429358e-02, 5.326460622998e-09, 7.614185155562e-05,
                                           1.493161533980e-05, 4.174696624492e-02, 3.059047600719e-05,
                                           1.585404732643e-01, 2.097043641165e-03, 1.266907256462e-02,
                                           9.109031525710e-05, 1.848903475088e-02, 2.912387282087e-04,
                                           2.051838076716e-02, 2.092789309202e-01, 1.269704586453e-03,
                                           2.334471534452e-01, 5.171704564102e-02, 1.309862296052e-01,
                                           2.575149696365e-04, 5.675279901416e-02, 3.112485872852e-02,
                                           4.447240349015e-08, 3.115675851950e-11, 1.778280563727e-08,
                                           6.339595490492e-11],
                          'support_min': -8,
                          'support_max': 19},
                         {'probs': [0.523464756059, 0.492775083668, 0.110963110829, 0.271307602951,
                                    0.431652240314, 0.329634080981, 0.089211644161, 0.025811292924],
                          'weights': [-2, -3, 4, -3, 2, -5, 3, 5],
                          'rho': 0.3966656443559087,
                          'weights_failure': [3, 0, -2, 0, 4, 0, 5, 3],
                          'expected_pmf': [1.039403642282e-02, 0.000000000000e+00, 3.358422528949e-02,
                                           7.666942934837e-03, 1.475105324558e-02, 4.791375147615e-02,
                                           1.063621576577e-02, 5.966407730302e-02, 4.044881478344e-02,
                                           2.506328034198e-02, 9.297993031460e-02, 1.695440533779e-02,
                                           8.734459231853e-02, 6.045730042944e-02, 1.564568734591e-02,
                                           1.316421995329e-01, 1.337076411920e-02, 7.418659740595e-02,
                                           5.125206939043e-02, 4.290496369813e-03, 1.872373581416e-01,
                                           6.593094573810e-03, 3.664897437311e-04, 2.980132718517e-03,
                                           1.720639464392e-03, 3.508484839186e-05, 2.805038889194e-03,
                                           0.000000000000e+00, 1.572149268839e-05],
                          'support_min': -7,
                          'support_max': 21},
                         {'probs': [0.692960674855, 0.417903523961, 0.428683832022, 0.042226326199,
                                    0.569762115184, 0.818918138166, 0.492865010992, 0.174357396236],
                          'weights': [4, 3, -3, 5, -1, -2, 4, 4],
                          'rho': 0.13428609795672786,
                          'weights_failure': [2, -1, 3, -4, -5, 1, -4, 3],
                          'expected_pmf': [1.191961132190e-02, 1.587048196383e-03, 2.148531671099e-02,
                                           7.995167811048e-03, 1.866038041959e-02, 8.959185921751e-03,
                                           7.192240690950e-02, 1.771404035028e-02, 5.676706862560e-02,
                                           3.075506564421e-02, 8.061117093817e-02, 3.529967543443e-02,
                                           7.950434733088e-02, 3.490469176968e-02, 8.170767899242e-02,
                                           4.206981211760e-02, 6.844944930643e-02, 3.235559182751e-02,
                                           6.586068154004e-02, 3.766625857677e-02, 6.016362138606e-02,
                                           2.691286920091e-02, 1.400929218018e-02, 1.806078730928e-02,
                                           3.642028325059e-02, 1.507880129841e-02, 1.770524694434e-03,
                                           9.244583392408e-03, 3.617727823357e-03, 2.689395618636e-03,
                                           1.270742001096e-03, 6.134713505840e-04, 5.147429632503e-04,
                                           2.170013669404e-03, 9.680744344528e-04, 1.651821442667e-05,
                                           2.154123837798e-04, 6.848908356506e-05],
                          'support_min': -14,
                          'support_max': 23},
                         {'probs': [0.05597889715, 0.024999715274, 0.696637437166, 0.071793041572,
                                    0.09678519405, 0.920095519061, 0.036100572278, 0.511229642285],
                          'weights': [-3, 0, 2, 3, 5, -2, 0, -2],
                          'rho': 0.44916933635502154,
                          'weights_failure': [-2, 2, 0, -5, -5, 2, 1, 5],
                          'expected_pmf': [4.073427667255e-06, 6.049820673161e-05, 8.730301583422e-04,
                                           4.458835366797e-03, 8.246299514963e-02, 2.788913425967e-02,
                                           2.627742153630e-01, 4.485897913263e-05, 6.593945525246e-03,
                                           4.524273392072e-04, 9.703502050272e-03, 1.659480268658e-01,
                                           1.326958149350e-02, 2.321158214283e-01, 3.244291950219e-02,
                                           5.451977491237e-02, 3.716482425461e-02, 2.023192396985e-02,
                                           3.710221338471e-04, 1.769914319517e-03, 2.336299894515e-03,
                                           1.180880394685e-02, 4.641279724256e-03, 1.681387887745e-02,
                                           8.949777524231e-03, 2.639496305454e-04, 1.031685781064e-05,
                                           2.422715455919e-04, 7.128194248023e-05, 2.168022804421e-04,
                                           3.189934504301e-04, 1.166149616051e-03, 8.270141907196e-08,
                                           1.686227288835e-06, 5.438644204621e-07, 6.557210604167e-06],
                          'support_min': -17,
                          'support_max': 18},
                         {'probs': [0.636898805117, 0.290969945445, 0.619125661932, 0.072582559888,
                                    0.285981588474, 0.335930670379, 0.24199143004, 0.010462271432,
                                    0.979049085182],
                          'weights': [-1, 2, -3, -1, 0, 2, -5, -1, 0],
                          'rho': 0.6073719890249881,
                          'weights_failure': [0, 4, 5, -2, 3, -1, -3, 2, -5],
                          'expected_pmf': [3.898395425646e-10, 8.361285087160e-11, 1.195987177489e-09,
                                           4.196723549554e-07, 1.478543178475e-07, 1.884968041778e-04,
                                           1.243207852991e-04, 1.451591263918e-04, 1.523216636904e-02,
                                           8.745381229715e-03, 2.672619064133e-02, 6.659140993062e-02,
                                           5.774942674340e-02, 9.690492401707e-02, 4.706513860415e-02,
                                           1.219392421700e-01, 1.186700709853e-01, 9.980977697902e-03,
                                           4.246889121469e-02, 3.556026156345e-02, 9.963582412653e-03,
                                           2.434900777120e-02, 1.227724647565e-02, 8.738078506514e-02,
                                           1.928811454765e-01, 2.326344776562e-03, 1.332199931903e-02,
                                           9.358170923222e-03, 4.909070140905e-05],
                          'support_min': -16,
                          'support_max': 12},
                         {'probs': [0.803121157045, 0.20763109394, 0.512451563262, 0.592004384269,
                                    0.554773298968, 0.846306441578, 0.75566891486, 0.567125304198,
                                    0.693188656331],
                          'weights': [-1, -3, -2, -1, 4, 4, -4, -5, -1],
                          'rho': 0.12615877773804662,
                          'weights_failure': [2, 4, -5, -2, 2, 5, 3, 2, 3],
                          'expected_pmf': [0.002865142363, 0.005908624156, 0.005275654417, 0.016163253224,
                                           0.012929608971, 0.01155284631, 0.028893755915, 0.022880566895,
                                           0.03024514979, 0.027927274089, 0.065358746413, 0.051931382555,
                                           0.046160998448, 0.085042712043, 0.052298550936, 0.046240839081,
                                           0.042543646381, 0.071631007553, 0.051705323891, 0.043830915614,
                                           0.061438386201, 0.042062624362, 0.030563155104, 0.02590297629,
                                           0.032422514457, 0.019568715805, 0.014727960719, 0.016342898338,
                                           0.012018729569, 0.007996945643, 0.005916931774, 0.005595366607,
                                           0.002055564812, 0.000958283067, 0.00087144327, 0.000171504939],
                          'support_min': -15,
                          'support_max': 20},
                         {'probs': [0.831144326297, 0.856287815619, 0.538449377811, 0.372446055161,
                                    0.879936724493, 0.485519620312, 0.213575652595, 0.636359426112,
                                    0.721453929057],
                          'weights': [3, 5, 4, 1, 4, -1, 4, -3, -1],
                          'rho': 0.425426728013098,
                          'weights_failure': [-4, 3, -3, 0, 0, -5, -3, -2, 1],
                          'expected_pmf': [0.000747854408, 0.002995407106, 0.003334636974, 0.016489173922,
                                           0.004778156529, 0.013762949503, 0.010738632093, 0.024755914261,
                                           0.01210708956, 0.022406178729, 0.020762499581, 0.017192157235,
                                           0.023241161381, 0.048106018742, 0.063110311003, 0.032500950667,
                                           0.038418363928, 0.041586699747, 0.047631106095, 0.024275737628,
                                           0.058018672373, 0.060705789038, 0.026101490618, 0.020352064695,
                                           0.06536580065, 0.105137799837, 0.02437326298, 0.023258724781,
                                           0.019804801417, 0.00462775893, 0.002979723419, 0.027419532933,
                                           0.081150873141, 0.007712129205, 0.003540962944, 0.000509613948],
                          'support_min': -16,
                          'support_max': 19},
                         {'probs': [0.34085633123, 0.709642830591, 0.652213749676, 0.927613002872,
                                    0.546705215328, 0.45051703602, 0.062914226077, 0.697403949643,
                                    0.669691730568, 0.10738924844],
                          'weights': [0, -1, 4, 5, -4, -3, 3, -3, 4, 0],
                          'rho': 0.11703706985907125,
                          'weights_failure': [4, 5, -5, -1, -2, -1, 0, 2, 1, -5],
                          'expected_pmf': [1.811161958854e-04, 0.000000000000e+00, 4.541204633691e-04,
                                           3.982312239714e-04, 7.866854708014e-04, 9.234987313769e-04,
                                           4.532113777719e-03, 1.608924094278e-03, 7.617563119817e-03,
                                           1.197296579554e-02, 1.012592232668e-02, 1.911737092337e-02,
                                           1.865314400756e-02, 2.652350055886e-02, 2.225105779466e-02,
                                           4.570767383417e-02, 1.750723947939e-02, 4.673413299649e-02,
                                           5.476131228584e-02, 3.883809382690e-02, 6.970649225411e-02,
                                           4.817813123957e-02, 7.293716208007e-02, 5.474047818499e-02,
                                           7.903239170932e-02, 3.962018526498e-02, 6.269881685272e-02,
                                           4.208936878265e-02, 3.747706214955e-02, 4.413624592369e-02,
                                           2.794692843419e-02, 2.396517189535e-02, 2.278074168980e-02,
                                           1.041057994209e-02, 9.747198312046e-03, 1.243913795909e-02,
                                           2.026268392774e-03, 8.175538515845e-03, 1.203404724375e-03,
                                           3.698017574925e-04, 1.074867547773e-03, 4.541468403720e-05,
                                           4.346727844350e-04, 4.874016362757e-05, 0.000000000000e+00,
                                           2.053184874800e-05],
                          'support_min': -21,
                          'support_max': 24},
                         {'probs': [0.584655520682, 0.270363208145, 0.829216102379, 0.651035206769,
                                    0.148204815261, 0.542130456279, 0.010456757855, 0.956427971269,
                                    0.222444058734, 0.638328698775],
                          'weights': [1, 5, 0, 4, 4, -1, 5, 1, 2, -4],
                          'rho': 0.627803197657736,
                          'weights_failure': [3, 0, -1, 0, 3, -4, -1, 4, 0, -1],
                          'expected_pmf': [3.554075430775e-03, 1.803180563065e-02, 1.213272866632e-02,
                                           3.798856863963e-02, 4.057768059873e-02, 1.080095252376e-01,
                                           9.215737162323e-02, 5.522971678319e-02, 1.372069138122e-01,
                                           6.307821968412e-02, 1.097604871172e-01, 4.658607130838e-02,
                                           2.400851948902e-02, 7.697628348236e-02, 2.715200433526e-02,
                                           6.149020385441e-02, 6.551694559634e-02, 4.767628516807e-03,
                                           5.117961636560e-03, 1.234028014959e-03, 9.565362735755e-04,
                                           1.431441253938e-03, 6.980871172685e-03, 1.963699785816e-05,
                                           2.542214705855e-05, 8.737297911198e-06, 4.228548661959e-07,
                                           1.923364110734e-07, 1.235642874818e-10, 7.352546958778e-11,
                                           1.076396130784e-11],
                          'support_min': -5,
                          'support_max': 25},
                         {'probs': [0.348628868533, 0.925201969648, 0.684426704161, 0.710859173043,
                                    0.394751491001, 0.871360209188, 0.490888459597, 0.209195473491,
                                    0.943887458916, 0.380602486628],
                          'weights': [-3, -1, 3, 3, -3, 3, -4, -1, 2, 5],
                          'rho': 0.12269769008962683,
                          'weights_failure': [-5, 2, -3, -2, 3, 1, 2, 1, 3, -4],
                          'expected_pmf': [1.085955000298e-04, 7.886618098935e-06, 1.487632224255e-03,
                                           1.200106436482e-04, 4.303905173048e-03, 7.038001413294e-04,
                                           2.303022107401e-03, 4.274164806599e-03, 8.951598898467e-03,
                                           1.184667792639e-02, 2.541674805733e-02, 1.008959259647e-02,
                                           1.144176295916e-02, 2.686578146981e-02, 1.754265301699e-02,
                                           6.508347960855e-02, 4.998497732805e-02, 4.115204002774e-02,
                                           2.904757030155e-02, 5.223187391513e-02, 1.860589802009e-02,
                                           1.007295546511e-01, 4.818118827121e-02, 5.083732088417e-02,
                                           6.477273446508e-02, 4.167901384909e-02, 3.267392285838e-02,
                                           5.582848069979e-02, 2.756994880016e-02, 2.233064174346e-02,
                                           6.572233915690e-02, 1.383907790340e-02, 3.295949393157e-02,
                                           8.403396562143e-03, 9.792098376306e-03, 1.967472354718e-03,
                                           2.495160724439e-02, 1.859813065994e-03, 1.135456743698e-02,
                                           2.175669160418e-03, 1.270913065294e-04, 6.377130080834e-04,
                                           3.718292997877e-05],
                          'support_min': -20,
                          'support_max': 22}, ]


def test_LFGPB_three_param():
    for test_case in simple_test_cases:
        probs = np.array(test_case['probs'])
        weights = np.array(test_case['weights'])
        rho = test_case['rho']
        expected = np.array(test_case['expected_pmf'])
        random_var = LFGPB(probs, weights, rho)
        assert np.allclose(random_var.pmf_vec, expected)


def test_LFGPB_four_param():
    for test_case in four_param_test_cases:
        probs = np.array(test_case['probs'])
        weights_success = np.array(test_case['weights'])
        weights_failure = np.array(test_case['weights_failure'])
        rho = test_case['rho']
        support_min = np.array(test_case['support_min'])
        support_max = np.array(test_case['support_max'])
        expected = np.array(test_case['expected_pmf'])
        random_var = LFGPB(probs, weights_success, rho, weights_failure)
        assert np.allclose(random_var.pmf_vec, expected)
        assert support_min == random_var.support_start
        assert support_max == random_var.support_end


def test_LFGPB_agrees_with_GPB_for_zero_rho_two_param():
    for test_case in simple_test_cases:
        probs = np.array(test_case['probs'])
        weights = np.array(test_case['weights'])
        expected = GPB(probs, weights).pmf_vec
        random_var = LFGPB(probs, weights, 0)
        assert np.allclose(random_var.pmf_vec, expected)


def test_LFGPB_agrees_with_GPB_for_unspecified_rho_two_param():
    for test_case in simple_test_cases:
        probs = np.array(test_case['probs'])
        weights = np.array(test_case['weights'])
        expected = GPB(probs, weights).pmf_vec
        random_var = LFGPB(probs, weights)
        assert np.allclose(random_var.pmf_vec, expected)


def test_LFGPB_agrees_with_GPB_for_zero_rho_three_param():
    for test_case in four_param_test_cases:
        probs = np.array(test_case['probs'])
        weights_success = np.array(test_case['weights'])
        weights_failure = np.array(test_case['weights_failure'])
        gpb_rv = GPB(probs, weights_success, weights_failure)
        support_min, support_max = gpb_rv.support()
        expected_pmf = gpb_rv.pmf_vec
        lfgpb_var = LFGPB(probs, weights_success, 0, weights_failure)
        assert np.allclose(lfgpb_var.pmf_vec, expected_pmf)
        assert support_min == lfgpb_var.support_start
        assert support_max == lfgpb_var.support_end


def test_LFGPB_agrees_with_GPB_for_unspecified_rho_three_param():
    for test_case in four_param_test_cases:
        probs = np.array(test_case['probs'])
        weights_success = np.array(test_case['weights'])
        weights_failure = np.array(test_case['weights_failure'])
        gpb_rv = GPB(probs, weights_success, weights_failure)
        support_min, support_max = gpb_rv.support()
        expected_pmf = gpb_rv.pmf_vec
        lfgpb_var = LFGPB(probs, weights_success, failure_weights=weights_failure)
        assert np.allclose(lfgpb_var.pmf_vec, expected_pmf)
        assert support_min == lfgpb_var.support_start
        assert support_max == lfgpb_var.support_end


def test_LFGPB_rho_not_castable_to_float():
    with pytest.raises(ValueError):
        random_var = LFGPB(np.array([0.1, 0.2, 0.3, 0.4]), np.array([1, 2, 3, 4]), 'spam or ham')


def test_LFGPB_rho_negative():
    with pytest.raises(ValueError):
        random_var = LFGPB(np.array([0.1, 0.2, 0.3, 0.4]), np.array([1, 2, 3, 4]), -0.5)


def test_LFGPB_rho_one():
    with pytest.raises(ValueError):
        random_var = LFGPB(np.array([0.1, 0.2, 0.3, 0.4]), np.array([1, 2, 3, 4]), 1.0)


def test_LFGPB_rho_large():
    with pytest.raises(ValueError):
        random_var = LFGPB(np.array([0.1, 0.2, 0.3, 0.4]), np.array([1, 2, 3, 4]), 3.0)


def test_LFGPB_epsilon_not_castable_to_float():
    with pytest.raises(ValueError):
        random_var = LFGPB(np.array([0.1, 0.2, 0.3, 0.4]), np.array([1, 2, 3, 4]), 0.5, epsilon='spam or ham')


def test_LFGPB_epsilon_negative():
    with pytest.raises(ValueError):
        random_var = LFGPB(np.array([0.1, 0.2, 0.3, 0.4]), np.array([1, 2, 3, 4]), 0.5, epsilon=-0.5)


def test_LFGPB_epsilon_zero():
    with pytest.raises(ValueError):
        random_var = LFGPB(np.array([0.1, 0.2, 0.3, 0.4]), np.array([1, 2, 3, 4]), 0.5, epsilon=0.0)


def test_LFGPB_epsilon_one():
    with pytest.raises(ValueError):
        random_var = LFGPB(np.array([0.1, 0.2, 0.3, 0.4]), np.array([1, 2, 3, 4]), 0.5, epsilon=1.0)


def test_LFGPB_epsilon_large():
    with pytest.raises(ValueError):
        random_var = LFGPB(np.array([0.1, 0.2, 0.3, 0.4]), np.array([1, 2, 3, 4]), 0.5, epsilon=3.0)
